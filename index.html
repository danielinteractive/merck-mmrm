<!DOCTYPE html>
<html lang="en"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.32">

  <meta name="author" content="Daniel Sabanés Bové">
  <title>{mmrm} and more from openstatsware</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto-14a6ea5696d7dd9e5afb4788ba95a7f9.css">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="https://github.com/openpharma/mmrm/raw/main/man/figures/logo.png" data-background-position="90% 90%" data-background-size="20%" class="quarto-title-block center">
  <h1 class="title"><code>{mmrm}</code> and more from <code>openstatsware</code></h1>
  <p class="subtitle">Merck &amp; Co., Inc., August 2024</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Daniel Sabanés Bové 
</div>
        <p class="quarto-title-affiliation">
            RCONIS
          </p>
    </div>
</div>

</section>
<section id="agenda" class="slide level2">
<h2>Agenda</h2>
<ul>
<li>Personal introduction</li>
<li>Introducing <code>openstatsware</code>
<ul>
<li>Our software packages</li>
<li>Our best practice materials</li>
</ul></li>
<li>Mixed Models for Repeated Measures and <code>{mmrm}</code></li>
<li>Ingredients for Successful Collaborations</li>
</ul>
</section>
<section>
<section id="personal-introduction" class="title-slide slide level1 center">
<h1>Personal introduction</h1>

</section>
<section id="daniel" class="slide level2">
<h2>Daniel</h2>
<div class="columns">
<div class="column" style="width:30%;">
<p><img data-src="resources/daniel.jpg"></p>
</div><div class="column" style="width:70%;">
<ul>
<li>Ph.D.&nbsp;in Statistics from University of Zurich, Bayesian Model Selection</li>
<li>Biostatistician at Roche for 5 years, Data Scientist at Google for 2 years, Statistical Software Engineer at Roche for 4 years</li>
<li>Co-founder of <a href="https://rconis.com">RCONIS</a> - we just had our 1st birthday!</li>
<li>Multiple R packages on CRAN and Bioconductor, co-wrote book on Likelihood and Bayesian Inference, chair of <code>openstatsware</code></li>
<li>Feel free to connect <a href="https://www.linkedin.com/in/danielsabanesbove/"><svg aria-hidden="true" role="img" viewbox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg></a> <a href="https://github.com/danielinteractive"><svg aria-hidden="true" role="img" viewbox="0 0 496 512" style="height:1em;width:0.97em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a> <a href="https://rconis.com"><svg aria-hidden="true" role="img" viewbox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M352 256c0 22.2-1.2 43.6-3.3 64H163.3c-2.2-20.4-3.3-41.8-3.3-64s1.2-43.6 3.3-64H348.7c2.2 20.4 3.3 41.8 3.3 64zm28.8-64H503.9c5.3 20.5 8.1 41.9 8.1 64s-2.8 43.5-8.1 64H380.8c2.1-20.6 3.2-42 3.2-64s-1.1-43.4-3.2-64zm112.6-32H376.7c-10-63.9-29.8-117.4-55.3-151.6c78.3 20.7 142 77.5 171.9 151.6zm-149.1 0H167.7c6.1-36.4 15.5-68.6 27-94.7c10.5-23.6 22.2-40.7 33.5-51.5C239.4 3.2 248.7 0 256 0s16.6 3.2 27.8 13.8c11.3 10.8 23 27.9 33.5 51.5c11.6 26 20.9 58.2 27 94.7zm-209 0H18.6C48.6 85.9 112.2 29.1 190.6 8.4C165.1 42.6 145.3 96.1 135.3 160zM8.1 192H131.2c-2.1 20.6-3.2 42-3.2 64s1.1 43.4 3.2 64H8.1C2.8 299.5 0 278.1 0 256s2.8-43.5 8.1-64zM194.7 446.6c-11.6-26-20.9-58.2-27-94.6H344.3c-6.1 36.4-15.5 68.6-27 94.6c-10.5 23.6-22.2 40.7-33.5 51.5C272.6 508.8 263.3 512 256 512s-16.6-3.2-27.8-13.8c-11.3-10.8-23-27.9-33.5-51.5zM135.3 352c10 63.9 29.8 117.4 55.3 151.6C112.2 482.9 48.6 426.1 18.6 352H135.3zm358.1 0c-30 74.1-93.6 130.9-171.9 151.6c25.5-34.2 45.2-87.7 55.3-151.6H493.4z"></path></svg></a></li>
</ul>
</div></div>
</section>
<section id="rconis" class="slide level2">
<h2>RCONIS</h2>

<img data-src="resources/rconis_team.jpg" class="center r-stretch"></section>
<section id="idea" class="slide level2">
<h2>Idea</h2>
<ul>
<li>Grow RPACT company to offer a wider range of services</li>
<li>Strengthen maintainer team for the <code>rpact</code> package</li>
<li>Team growth combined with scope growth</li>
<li>Statistical consulting and engineering services:<br>
<em>R</em>esearch <em>Con</em>sulting and <em>I</em>nnovative <em>S</em>olutions</li>
<li>Website: <a href="https://rconis.com">rconis.com</a></li>
</ul>
</section></section>
<section>
<section id="introducing-openstatsware" class="title-slide slide level1 center">
<h1>Introducing <code>openstatsware</code></h1>

</section>
<section id="openstatsware" class="slide level2">
<h2><code>openstatsware</code></h2>
<ul>
<li>Formed on 19 August 2022, affiliated with American Statistical Association (ASA) as well as European Federation of Statisticians in the Pharma Industry (EFSPI)</li>
<li>Cross pharma industry collaboration (59 members from 38 organizations)</li>
<li>Homepage at <a href="https://openstatsware.org">openstatsware.org</a></li>
<li>We welcome new members to join!</li>
</ul>
</section>
<section id="working-group-objectives" class="slide level2">
<h2>Working Group Objectives</h2>
<ul>
<li>Primary
<ul>
<li>Engineer R packages that implement important statistical methods
<ul>
<li>to fill in gaps in the open-source statistical software landscape</li>
<li>focusing on what is needed for biopharmaceutical applications</li>
</ul></li>
</ul></li>
<li>Secondary
<ul>
<li>Develop and disseminate best practices for engineering high-quality open-source statistical software
<ul>
<li>By actively doing the statistical engineering work together, we align on best practices and can communicate these to others</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="bayesian-mmrm-r-package" class="slide level2">
<h2>Bayesian MMRM R Package</h2>
<ul>
<li>The <a href="https://cran.r-project.org/package=brms.mmrm"><code>brms.mmrm</code></a> R package leverages <code>brms</code> to run Bayesian MMRM
<ul>
<li><a href="https://cran.r-project.org/package=brms"><code>brms</code></a> is a powerful and versatile package for fitting Bayesian regression models</li>
</ul></li>
<li>Support a simplified interface and align with the best practices</li>
<li><a href="https://openpharma.github.io/brms.mmrm/">Documentation website</a> has a complete function reference and tutorial vignettes</li>
<li>Rigorous validation using simulation-based calibration and comparisons with the frequentist <code>mmrm</code> package on two example datasets</li>
</ul>
</section>
<section id="matching-adjusted-indirect-comparison-r-package" class="slide level2">
<h2>Matching-adjusted indirect comparison R package</h2>
<ul>
<li><a href="https://cran.r-project.org/package=maicplus"><code>maicplus</code></a> is an R package to support analysis and reporting of matching-adjusted indirect comparison (MAIC) for HTA dossiers (<a href="https://hta-pharma.github.io/maicplus/">docs</a>)</li>
<li>Motivation:
<ul>
<li>Sponsors are required to submit evidence of relative effectiveness of their treatment comparing to relevant comparators that may not be included in their clinical trial, for health technology assessment (HTA) in different countries</li>
<li>MAIC is a prevalent and well-accepted method to derive population-adjusted treatment effect in such case for two trials, one of which has Individual patient data and the other has only aggregate data</li>
</ul></li>
<li>In close collaboration with <a href="https://www.psiweb.org/sigs-special-interest-groups/hta">HTA SIG in PSI/EFPSI</a> (a group of HTA SMEs with statistical background, who help to generate pipeline ideas, ensure relevance of developed tools, pilot created tools in real business setting)</li>
</ul>
</section>
<section id="bayesian-safety-signal-detection-julia-package" class="slide level2">
<h2>Bayesian Safety Signal Detection julia package</h2>
<ul>
<li><a href="https://openpharma.github.io/SafetySignalDetection.jl/"><code>SafetySignalDetection.jl</code></a> implements Bayesian safety signal detection as proposed by <a href="https://openpharma.github.io/SafetySignalDetection.jl/stable/#Brock:2023">Brock et al.&nbsp;(2023)</a> using the <a href="https://github.com/TuringLang/Turing.jl">Turing.jl</a> framework.</li>
<li>Please have a look at the corresponding <a href="https://openpharma.github.io/SafetySignalDetection.jl/stable/introduction/">introduction</a> to learn more</li>
<li>If you are interested why Julia is interesting for implementing statistical software, check out <a href="https://www.youtube.com/watch?v=yAqLMwnO-Kk&amp;list=PLMtxz1fUYA5Bv-Fi3EJk59oSqdE19CQ4f&amp;index=4">R(omeo) and Julia: A Love Story</a></li>
</ul>
</section>
<section id="openstatsguide" class="slide level2">
<h2>openstatsguide</h2>
<ul>
<li>Small and concise set of recommendations for package developers</li>
<li>Opinionated, but aims to be based on experienced majority opinions</li>
<li>Focus are developers, while users might find complementary “validation” frameworks valuable</li>
<li>Primarily for statistical packages (not plotting, data wrangling, etc.)</li>
<li>Generic principles which can be used across functional data science languages R, Python, and Julia</li>
<li>Concrete tools are mentioned as examples</li>
</ul>
</section>
<section id="section" class="slide level2" data-background-iframe="https://openstatsware.org/guide.html">
<h2></h2>
</section>
<section id="workshop-tour-on-good-software-engineering" class="slide level2">
<h2>Workshop Tour on Good Software Engineering</h2>
<ol type="1">
<li><a href="https://kkmann.github.io/workshop-r-swe/">10th February 2023, Basel, CH</a></li>
<li><a href="https://openpharma.github.io/workshop-r-swe/">24th March 2023, Shanghai, CN</a></li>
<li><a href="https://openpharma.github.io/workshop-r-swe-sf/">20th July 2023, San José, CA, US</a></li>
<li><a href="https://openpharma.github.io/workshop-r-swe-md/">26th September 2023, Rockville, MD, US</a></li>
<li><a href="https://openpharma.github.io/workshop-r-swe-mtl/">16th and 17th October 2023, Montreal, QC, CA</a></li>
<li><a href="https://rconis.github.io/workshop-r-swe-zrh/">18th and 19th April 2024, Zurich, CH</a></li>
<li><a href="https://rconis.github.io/user2024-tutorial-gswep/">8th July 2024, Salzburg, AT</a></li>
<li><a href="https://www.linkedin.com/posts/yuichi-nakajima-8984759a_r-package-development-workshop-by-daniel-activity-7305102975851511810-QPl_?utm_source=share&amp;utm_medium=member_desktop&amp;rcm=ACoAAAeLiYUB2lCTxf2k2-ROB6XktxT7lyQYIaQ">8th April 2025, Tokyo, JP</a></li>
<li><a href="https://isbiostat.org/short-courses/#CS3">12th August 2025, Philadelphia, PA, US</a></li>
<li><a href="https://openstatsware.github.io/shortcourse-iscb2025/">24th August 2025, Basel, CH</a></li>
<li><a href="https://rconis.github.io/SnB2025-shortcourse/">10th October 2025, Paris, France</a></li>
</ol>
</section></section>
<section>
<section id="mixed-models-for-repeated-measures-and-mmrm" class="title-slide slide level1 center">
<h1>Mixed Models for Repeated Measures and <code>{mmrm}</code></h1>

</section>
<section id="what-is-a-mmrm" class="slide level2">
<h2>What is a MMRM?</h2>
<ul>
<li>MMRM is a popular choice for analyzing longitudinal continuous outcomes in randomized clinical trials</li>
<li>For each subject <span class="math inline">\(i\)</span> we observe a vector <span class="math display">\[
Y_i = (y_{i1}, \dotsc, y_{im_i})^\top \in \mathbb{R}^{m_i}
\]</span></li>
<li>Use a design matrix <span class="math inline">\(X_i \in \mathbb{R}^{m_i \times p}\)</span></li>
<li>Use a corresponding coefficient vector <span class="math inline">\(\beta \in \mathbb{R}^{p}\)</span></li>
<li>Assume that the observations are multivariate normal distributed: <span class="math display">\[
Y_i \sim N(X_i\beta, \Sigma_i)
\]</span> where the covariance matrix <span class="math inline">\(\Sigma_i \in \mathbb{R}^{m_i \times m_i}\)</span> is derived by subsetting the overall covariance matrix <span class="math inline">\(\Sigma \in \mathbb{R}^{m \times m}\)</span> appropriately</li>
</ul>
</section>
<section id="covariance-model-and-estimation" class="slide level2">
<h2>Covariance model and Estimation</h2>
<ul>
<li>The symmetric and positive definite covariance matrix <span class="math inline">\(\Sigma\)</span> is parametrized by a vector of variance parameters <span class="math inline">\(\theta = (\theta_1, \dotsc, \theta_k)^\top\)</span></li>
<li>There are many different choices for how to model the covariance matrix and correspondingly <span class="math inline">\(\theta\)</span> has different interpretations, e.g.:
<ul>
<li>Unstructured, Toeplitz, AR1, compound symmetry, ante-dependence, spatial exponential</li>
<li>Group specific covariance estimates and weights</li>
</ul></li>
<li>Estimation is performed
<ul>
<li>(sometimes) via maximum likelihood (ML) inference, maximizing the joint log-likelihood of <span class="math inline">\((\beta, \theta)\)</span> or</li>
<li>(usually) via integrating out <span class="math inline">\(\beta\)</span> from the likelihood and maximizing for <span class="math inline">\(\theta\)</span> (restricted ML, REML)</li>
</ul></li>
</ul>
</section>
<section id="existing-r-packages-and-tried-solutions" class="slide level2">
<h2>Existing R Packages and Tried Solutions</h2>
<ul>
<li>One challenge is that we need to use “adjusted” degrees of freedom for t- or F-test statistics
<ul>
<li>because of the covariance parameter estimation and data sets are usually unbalanced</li>
<li>Typical Satterthwaite or Kenward-Roger adjustment methods</li>
</ul></li>
<li>Initially thought that the MMRM problem was solved by using <code>lme4</code> with <code>lmerTest</code>, learned that this approach failed on large data sets (slow, did not converge)</li>
<li><code>nlme</code> does not give Satterthwaite adjusted degrees of freedom, has convergence issues, and with <code>emmeans</code> it is only approximate</li>
<li>Next we tried to extend <code>glmmTMB</code> to calculate Satterthwaite adjusted degrees of freedom, but it did not work</li>
</ul>
</section>
<section id="new-idea" class="slide level2">
<h2>New Idea</h2>
<ul>
<li>We only want to fit a fixed effects model with a structured covariance matrix for each subject</li>
<li>The idea is then to use the Template Model Builder (<code>TMB</code>) directly
<ul>
<li>as it is also underlying <code>glmmTMB</code></li>
<li>but code the exact model we want</li>
</ul></li>
<li>We do this by implementing the log-likelihood in <code>C++</code> using the <code>TMB</code> provided libraries</li>
<li>Provide an R solution that
<ul>
<li>has fast convergence times</li>
<li>generates estimates closest to (previous) “gold standard” implementation (<code>SAS</code>)</li>
</ul></li>
</ul>
</section>
<section id="advantages-of-tmb" class="slide level2">
<h2>Advantages of <code>TMB</code></h2>
<ul>
<li>Fast <code>C++</code> framework for defining objective functions (<code>Rcpp</code> would have been alternative interface)</li>
<li>Automatic differentiation of the log-likelihood as a function of the variance parameters</li>
<li>We get the gradient and Hessian exactly and without additional coding</li>
<li>Syntactic sugars to allow simple matrix calculations or operations like R</li>
<li>This can be used from the R side with the <code>TMB</code> interface and plugged into optimizers</li>
</ul>
</section>
<section id="why-its-not-just-another-package" class="slide level2">
<h2>Why it’s not just another package</h2>
<ul>
<li>Ongoing maintenance and support from the pharmaceutical industry
<ul>
<li>5 companies being involved in the funding, on track to become standard package</li>
</ul></li>
<li>Development using best practices as show case for high quality package
<ul>
<li>Thorough and transparent unit and integration <a href="https://github.com/openpharma/mmrm/tree/main/tests/testthat">tests</a> to ensure accurate results</li>
<li>The integration tests in <code>{mmrm}</code> are set to a tolerance of <span class="math inline">\(10^{-3}\)</span> when compared to SAS outputs.</li>
<li>Uses the <code>testthat</code> framework with <code>covr</code> to communicate the testing coverage</li>
</ul></li>
</ul>
</section>
<section id="highlighted-features-of-mmrm" class="slide level2">
<h2>Highlighted Features of <code>mmrm</code></h2>
<ul>
<li><strong>Hypothesis Testing</strong>:
<ul>
<li><code>emmeans</code> interface for least square means</li>
<li>Satterthwaite and Kenward-Roger adjustments</li>
<li>Robust sandwich estimator for covariance</li>
</ul></li>
<li><strong>Integrations and extentions</strong>
<ul>
<li><code>tidymodels</code> builtin parsnip engine and recipes for streamlined model fitting workflows</li>
<li><code>teal</code>, <code>tern</code>, <code>rtables</code> integration for post processing and reporting</li>
<li>Support conditional mean prediction and simulation</li>
<li>Also used in <code>rbmi</code> for conditional mean imputation!</li>
</ul></li>
</ul>
</section>
<section id="computational-efficiency" class="slide level2">
<h2>Computational Efficiency</h2>
<p><code>mmrm</code> not only supports multiple covariance structure, it also has good efficiency (due to fast implementations in C++)</p>
<table class="caption-top">
<caption>Comparison of convergence times (ms) for example (<a href="https://openpharma.github.io/mmrm/latest/articles/mmrm_review_methods.html#fev-data-1">source</a>)</caption>
<thead>
<tr class="header">
<th>Implementation</th>
<th>Median</th>
<th>First Quartile</th>
<th>Third Quartile</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>mmrm</code></td>
<td>56.15</td>
<td>55.76</td>
<td>56.30</td>
</tr>
<tr class="even">
<td><code>PROC GLIMMIX</code></td>
<td>100.00</td>
<td>100.00</td>
<td>100.00</td>
</tr>
<tr class="odd">
<td><code>lmer</code></td>
<td>247.02</td>
<td>245.25</td>
<td>257.46</td>
</tr>
<tr class="even">
<td><code>gls</code></td>
<td>687.63</td>
<td>683.50</td>
<td>692.45</td>
</tr>
<tr class="odd">
<td><code>glmmTMB</code></td>
<td>715.90</td>
<td>708.70</td>
<td>721.57</td>
</tr>
</tbody>
</table>
</section>
<section id="differences-with-sas" class="slide level2">
<h2>Differences with SAS</h2>
<p><code>{mmrm}</code> has small difference from SAS</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="resources/mmrm-review-treatment-fev-1.png" style="height:100.0%"></p>
<figcaption>Marginal mean treatment effects for each visit (<a href="https://openpharma.github.io/mmrm/v0.3.12/articles/mmrm_review_methods.html#fev-data-2">source</a>)</figcaption>
</figure>
</div>
</section>
<section id="impact-of-mmrm" class="slide level2">
<h2>Impact of <code>mmrm</code></h2>
<ul>
<li><p>CRAN downloads: 3689 per month, over 100k in total so far (25th July 2025)</p>
<ul>
<li><a href="https://cran.r-project.org/web/packages/mmrm/">https://cran.r-project.org/web/packages/mmrm/</a></li>
</ul></li>
<li><p>GitHub repository: 143 stars (25th July 2025)</p>
<ul>
<li><a href="https://github.com/openpharma/mmrm">https://github.com/openpharma/mmrm</a></li>
</ul></li>
<li><p>Quite a lot of questions on StackOverflow</p></li>
<li><p>Most important features have been implemented by now … but still room for new features:</p>
<ul>
<li>additional random effects</li>
<li>nested covariance structures</li>
<li>Kenward-Roger version 2</li>
</ul></li>
</ul>
</section>
<section id="getting-started" class="slide level2">
<h2>Getting started</h2>
<ul>
<li><code>mmrm</code> is on CRAN - use this as a starting point:</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a><span class="fu">install.packages</span>(<span class="st">"mmrm"</span>)</span>
<span id="cb1-2"><a></a><span class="fu">library</span>(mmrm)</span>
<span id="cb1-3"><a></a>fit <span class="ot">&lt;-</span> <span class="fu">mmrm</span>(</span>
<span id="cb1-4"><a></a>    <span class="at">formula =</span> FEV1 <span class="sc">~</span> RACE <span class="sc">+</span> SEX <span class="sc">+</span> ARMCD <span class="sc">*</span> AVISIT <span class="sc">+</span> <span class="fu">us</span>(AVISIT <span class="sc">|</span> USUBJID),</span>
<span id="cb1-5"><a></a>    <span class="at">data =</span> fev_data</span>
<span id="cb1-6"><a></a>)</span>
<span id="cb1-7"><a></a><span class="fu">summary</span>(fit)</span>
<span id="cb1-8"><a></a><span class="fu">library</span>(emmeans)</span>
<span id="cb1-9"><a></a><span class="fu">emmeans</span>(fit, <span class="sc">~</span> ARMCD <span class="sc">|</span> AVISIT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Visit <a href="https://openpharma.github.io/mmrm/">openpharma.github.io/mmrm</a> for detailed docs including vignettes
<ul>
<li>In particular the <a href="https://openpharma.github.io/mmrm/main/articles/mmrm_review_methods.html">comparison vignette</a></li>
</ul></li>
<li>Consider <a href="https://insightsengineering.github.io/tern.mmrm/main/">tern.mmrm</a> for high-level clinical reporting interface, incl.&nbsp;standard tables and graphs</li>
</ul>
</div>
</section>
<section id="going-beyond-the-mar-assumption" class="slide level2">
<h2>Going beyond the MAR assumption</h2>
<ul>
<li>Analyzing a primary outcome with MMRM will likely be critized by regulators regarding the required missing at random (MAR) assumption</li>
<li>More complex methods have been developed to address this, such as reference-based multiple imputation (RBMI) or delta adjustment</li>
<li>The <a href="https://insightsengineering.github.io/rbmi"><code>rbmi</code> package</a> implements these methods, and internally uses <code>mmrm</code>:
<ul>
<li>Bayesian inference (with Stan implementation)</li>
<li>approximate Bayesian multiple imputation combined with Rubin’s rules for inference, and</li>
<li>frequentist conditional mean imputation combined with (jackknife or bootstrap) resampling.</li>
</ul></li>
</ul>
</section></section>
<section>
<section id="ingredients-for-successful-and-sustainable-collaboration" class="title-slide slide level1 center">
<h1>Ingredients for successful and sustainable collaboration</h1>

</section>
<section id="human-factors" class="slide level2">
<h2>Human factors</h2>
<ul>
<li>Mutual interest and trust</li>
<li>Prerequisite is getting to know each other
<ul>
<li>Although mostly just online, biweekly calls help a lot with this</li>
</ul></li>
<li>Reciprocity mindset
<ul>
<li>“Reciprocity means that in response to friendly actions, people are frequently much nicer and much more cooperative than predicted by the self-interest model”</li>
<li>Personal experience: If you first give away something, more will come back to you.</li>
</ul></li>
</ul>
</section>
<section id="development-process" class="slide level2">
<h2>Development process</h2>
<ul>
<li>Important to go public as soon as possible
<ul>
<li>don’t wait for the product to be finished</li>
<li>you never know who else might be interested/could help</li>
</ul></li>
<li>Version control with git
<ul>
<li>cornerstone of effective collaboration</li>
</ul></li>
<li>Building software together works better than alone
<ul>
<li>Different perspectives in discussions and code review help to optimize the user interface and thus experience</li>
</ul></li>
</ul>
</section>
<section id="coding-standards" class="slide level2">
<h2>Coding standards</h2>
<ul>
<li>Consistent and readable code style simplifies joint work</li>
<li>Written (!) contribution guidelines help</li>
<li>Lowering the entry hurdle using developer calls is important</li>
</ul>
</section>
<section id="robust-test-suite" class="slide level2">
<h2>Robust test suite</h2>
<ul>
<li>Unit and integration tests are essential for preventing regression and assuring quality</li>
<li>Especially with compiled code critical to see if package works correctly</li>
<li>Use continuous integration during development to make sure nothing breaks along the way</li>
</ul>
</section>
<section id="documentation" class="slide level2">
<h2>Documentation</h2>
<ul>
<li>Lots of work but extremely important
<ul>
<li>start with writing up the methods details</li>
<li>think about the code structure first in a “design doc”</li>
<li>only then put the code in the package</li>
</ul></li>
<li>Needs to be kept up-to-date</li>
<li>Need to have examples &amp; vignettes
<ul>
<li>Testing alone is not sufficient</li>
<li>Builds trust with users</li>
<li>Reference for developers over time</li>
</ul></li>
</ul>
</section>
<section id="acknowledgments" class="slide level2">
<h2>Acknowledgments</h2>
<p>Thanks to all other authors of <code>{mmrm}</code>:</p>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Brian Matthew Lang (MSD)</li>
<li>Christian Stock (Boehringer)</li>
<li>Dan James (AstraZeneca)</li>
<li>Daniel Leibovitz (Roche)</li>
<li>Daniel Sjoberg (Roche)</li>
<li>Doug Kelkhoff (Roche)</li>
</ul>
</div><div class="column" style="width:50%;">
<ul>
<li>Julia Dedic (Roche)</li>
<li>Jonathan Sidi (Sanofi)</li>
<li>Kevin Kunzmann (Boehringer)</li>
<li>Liming Li (Roche)</li>
<li>Nikolas I. Krieger (Experis)</li>
<li>Ya Wang (Gilead)</li>
</ul>
</div></div>
</section>
<section id="acknowledgments-1" class="slide level2">
<h2>Acknowledgments</h2>
<p>Thanks for discussions and contributions from:</p>
<ul>
<li>Ben Bolker (McMaster University)</li>
<li>Davide Garolini (Roche)</li>
<li>Craig Gower-Page (Roche)</li>
<li>Dinakar Kulkarni (Roche)</li>
<li>Gonzalo Duran Pacheco (Roche)</li>
<li>Lukas A. Widmer (Novartis)</li>
<li>Members of <code>openstatsware</code></li>
</ul>
</section>
<section id="thank-you-questions" class="slide level2">
<h2>Thank you! Questions?</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="https://github.com/openpharma/mmrm/raw/main/man/figures/logo.png" height="500"></p>
</div><div class="column" style="width:50%;">
<p><img data-src="https://github.com/openstatsware/website/raw/main/sticker/openstatsware-hex-1200.png" height="500"></p>
</div></div>
<p>These slides are at <a href="https://danielinteractive.github.io/merck-mmrm/">danielinteractive.github.io/merck-mmrm</a></p>


</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="https://github.com/openstatsware/website/raw/main/sticker/openstatsware-hex-1200.png" class="slide-logo"></p>
<div class="footer footer-default">
<p><code>{mmrm}</code> and more from <code>openstatsware</code> | <a href="http://creativecommons.org/licenses/by-sa/4.0/" title="License: CC BY-SA 4.0">License</a></p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp("https:\/\/danielinteractive\.github\.io\/merck-mmrm\/");
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>